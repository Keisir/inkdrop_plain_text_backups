{"version":3,"sources":["../src/restore_modal.js"],"names":["RestoreModal","React","Component","constructor","props","CompositeDisposable","dialogRef","isShown","showDialog","dismissDialog","open","subscriptions","add","inkdrop","commands","document","body","toggle","componentWillUnmount","dispose","render","MessageDialog","components","classes","el","closable","autofocus","label","cancel","primary","caller","buttonIndex"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;;;;;AAEA,MAAMA,YAAN,SAA2BC,KAAK,CAACC,SAAjC,CAA2C;AAIvCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;;AADe,2CAFH,IAAIC,6BAAJ,EAEG;;AAAA,oCAYV,MAAM;AACX,YAAM;AAAEC,QAAAA;AAAF,UAAgB,IAAtB;;AACA,UAAI,CAACA,SAAS,CAACC,OAAf,EAAwB;AACpBD,QAAAA,SAAS,CAACE,UAAV;AACH,OAFD,MAEO;AACHF,QAAAA,SAAS,CAACG,aAAV;AACH;AACJ,KAnBkB;;AAGf,SAAKC,IAAL,GAAY,KAAZ,CAHe,CAIf;;AACA,SAAKC,aAAL,CAAmBC,GAAnB,CACIC,OAAO,CAACC,QAAR,CAAiBF,GAAjB,CAAqBG,QAAQ,CAACC,IAA9B,EAAoC;AAChC,0CAAoC,KAAKC;AADT,KAApC,CADJ;AAKH;;AAWDC,EAAAA,oBAAoB,GAAG;AACnB,SAAKP,aAAL,CAAmBQ,OAAnB;AACH,GA3BsC,CA4BvC;AACA;AACA;AACA;AACA;;;AAEAC,EAAAA,MAAM,GAAG;AACL,UAAM;AAAEC,MAAAA;AAAF,QAAoBR,OAAO,CAACS,UAAR,CAAmBC,OAA7C;AACA;;AACA,QAAI,KAAKnB,KAAL,CAAWM,IAAf,EAAqB;AACjB,WAAKF,UAAL;AACH;;AACD,wBACI,oBAAC,aAAD;AACI,MAAA,GAAG,EAAGgB,EAAD,IAAQ;AACT,eAAQ,KAAKlB,SAAL,GAAiBkB,EAAzB;AACH,OAHL;AAII,MAAA,aAAa,EAAE;AAAEC,QAAAA,QAAQ,EAAE,KAAZ;AAAmBC,QAAAA,SAAS,EAAE;AAA9B,OAJnB;AAKI,MAAA,KAAK,EAAE,mBACH,+CACI;AAAG,QAAA,SAAS,EAAC;AAAb,QADJ,qCANR;AAWI,MAAA,OAAO,EAAE,CACL;AAAEC,QAAAA,KAAK,EAAE,IAAT;AAAeC,QAAAA,MAAM,EAAE;AAAvB,OADK,EAEL;AAAED,QAAAA,KAAK,EAAE,KAAT;AAAgBE,QAAAA,OAAO,EAAE;AAAzB,OAFK,CAXb;AAeI,MAAA,SAAS,EAAE,OAAOC,MAAP,EAAeC,WAAf,KAA+B;AACtC;;AACA,YAAIA,WAAW,KAAK,CAApB,EAAuB;AACnB;AACA,gBAAM,4BAAN;AACH,SAHD,MAGO;AACH;AACA,iBAAO,IAAP;AACH;AACJ;AAxBL,oBA0BI,gGAEM,kCAFN,OA1BJ,CADJ;AAiCH;;AAzEsC;;gBAArC/B,Y,gBACkB,O;;eA2ETA,Y","sourcesContent":["import * as React from \"react\";\nimport { getPlainTextPath, restoreAll } from \"./utilities\";\nimport { CompositeDisposable } from \"event-kit\";\n\nclass RestoreModal extends React.Component {\n    static layoutName = \"modal\";\n    subscriptions = new CompositeDisposable();\n\n    constructor(props) {\n        super(props);\n\n        this.open = false;\n        // Register command that toggles this dialog\n        this.subscriptions.add(\n            inkdrop.commands.add(document.body, {\n                \"plain_text_backups:toggle-dialog\": this.toggle,\n            })\n        );\n    }\n\n    toggle = () => {\n        const { dialogRef } = this;\n        if (!dialogRef.isShown) {\n            dialogRef.showDialog();\n        } else {\n            dialogRef.dismissDialog();\n        }\n    };\n\n    componentWillUnmount() {\n        this.subscriptions.dispose();\n    }\n    // open() {\n    // if (!this?.dialog?.isShown) {\n    // this?.dialog?.showDialog();\n    // }\n    // }\n\n    render() {\n        const { MessageDialog } = inkdrop.components.classes;\n        debugger;\n        if (this.props.open) {\n            this.showDialog();\n        }\n        return (\n            <MessageDialog\n                ref={(el) => {\n                    return (this.dialogRef = el);\n                }}\n                modalSettings={{ closable: false, autofocus: true }}\n                title={() => (\n                    <span>\n                        <i className=\"redo icon\" />\n                        Restore from plain text backups?\n                    </span>\n                )}\n                buttons={[\n                    { label: \"No\", cancel: true },\n                    { label: \"Yes\", primary: true },\n                ]}\n                onDismiss={async (caller, buttonIndex) => {\n                    debugger;\n                    if (buttonIndex === 1) {\n                        // User confirms restoration:\n                        await restoreAll();\n                    } else {\n                        // User rejects restoration:\n                        return true;\n                    }\n                }}\n            >\n                <p>\n                    Are you sure you want to restore from your plain text notes\n                    ({getPlainTextPath()})?\n                </p>\n            </MessageDialog>\n        );\n    }\n}\n\nexport default RestoreModal;\n"],"file":"restore_modal.js"}